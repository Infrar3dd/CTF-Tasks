from pwn import *
import re

context.arch = 'i386'

def main():
    p = process('./buf2d')
    
    sizes = [1001, 1002, 1003, 1004, 1005]
    
    p.recvuntil("=== Sorting Speed Test ===")
    p.recvuntil("Enter 5 array sizes (each between 1000 and 10000)")
    
    for i in range(5):
        p.recvuntil(f"Size {i+1} (1000~ 10000): ")
        p.sendline(str(sizes[i]))
    
    for j in range(5):
        v11 = sizes[j]
        p.recvuntil(f"Enter {v11} integers for array #{j+1}:")
        
        sorted_array = list(range(v11))

        for k in range(v11):
            p.sendline(str(sorted_array[k]))
    
    p.recvuntil("Wait... bubble faster? You must be hacking...")
    p.recvuntil("flag: ")
    flag = p.recvline().decode().strip()
    print(f"Flag: {flag}")
    
    p.close()

if __name__ == "__main__":
    main()

